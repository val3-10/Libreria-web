<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel Administrador - Booknest</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Barra de depuraciÃ³n opcional */
    #debug-bar { position: fixed; right: 12px; bottom: 12px; z-index: 999; }
    #debug-bar button { margin-left: 6px; }
  </style>
</head>
<body>
  <header class="site-header">
    <h1>ðŸ“š Booknest - Admin</h1>
    <button class="logout-btn" onclick="logout()">Cerrar SesiÃ³n</button>
  </header>

  <div class="container">
    <div class="seccion">
      <h2>Registrar Libro</h2>
      <label for="titulo">TÃ­tulo:</label>
      <input type="text" id="titulo" placeholder="Nombre del libro">

      <label for="autor">Autor:</label>
      <input type="text" id="autor" placeholder="Autor del libro">

      <label for="estado">Estado:</label>
      <select id="estado">
        <option value="disponible">Disponible</option>
        <option value="venta">En venta</option>
        <option value="prestamo">En prÃ©stamo</option>
      </select>

      <button id="btnAgregar" type="button">Agregar Libro</button>
    </div>

    <div class="seccion">
      <h2>Lista de Libros</h2>
      <table id="tablaLibrosAdmin">
        <thead>
          <tr>
            <th>TÃ­tulo</th>
            <th>Autor</th>
            <th>Estado</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- Barra de debug -->
  <div id="debug-bar">
    <button id="btnShowLibros" type="button">Mostrar array</button>
    <button id="btnClearLibros" type="button">Borrar localStorage</button>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const tituloEl = document.getElementById('titulo');
    const autorEl  = document.getElementById('autor');
    const estadoEl = document.getElementById('estado');
    const tbody    = document.querySelector('#tablaLibrosAdmin tbody');
    const btnAgregar = document.getElementById('btnAgregar');
    const btnShow = document.getElementById('btnShowLibros');
    const btnClear = document.getElementById('btnClearLibros');

    // Cargar libros de localStorage
    function loadLibros() {
      try {
        const raw = localStorage.getItem('libros');
        return raw ? JSON.parse(raw) : [];
      } catch (e) {
        console.error('Error cargando libros:', e);
        return [];
      }
    }
    window.libros = loadLibros();

    function guardarLibros() {
      localStorage.setItem('libros', JSON.stringify(window.libros));
    }

    function mostrarLibrosAdmin() {
      tbody.innerHTML = '';
      window.libros.forEach((libro, index) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${libro.titulo}</td>
          <td>${libro.autor}</td>
          <td class="${libro.estado}">${libro.estado}</td>
          <td><button type="button" class="btn-eliminar" data-index="${index}">Eliminar</button></td>
        `;
        tbody.appendChild(tr);
      });

      // listeners para eliminar
      tbody.querySelectorAll('.btn-eliminar').forEach(btn => {
        btn.addEventListener('click', () => {
          eliminarLibro(parseInt(btn.dataset.index));
        });
      });
    }

    function agregarLibro() {
      const titulo = tituloEl.value.trim();
      const autor = autorEl.value.trim();
      const estado = estadoEl.value;

      if (!titulo || !autor) {
        alert('Completa todos los campos.');
        return;
      }

      window.libros.push({ titulo, autor, estado });
      guardarLibros();
      mostrarLibrosAdmin();

      // limpiar inputs
      tituloEl.value = '';
      autorEl.value = '';
      estadoEl.value = 'disponible';
    }

    function eliminarLibro(index) {
      window.libros.splice(index, 1);
      guardarLibros();
      mostrarLibrosAdmin();
    }

    function logout() {
      localStorage.removeItem('rol');
      window.location.href = 'login.html';
    }

    // Eventos
    btnAgregar.addEventListener('click', agregarLibro);
    btnShow.addEventListener('click', () => console.log(window.libros));
    btnClear.addEventListener('click', () => {
      localStorage.removeItem('libros');
      window.libros = [];
      mostrarLibrosAdmin();
    });

    // Inicializar tabla
    mostrarLibrosAdmin();
  });
  </script>
</body>
</html>
